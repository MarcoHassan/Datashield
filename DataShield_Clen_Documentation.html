<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-10-09 Fri 14:30 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>DataShield - Run your Docker images in Software Guard Extensions Enclaves and Protect your Application at Runtime</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Marco Hassan" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">DataShield - Run your Docker images in Software Guard Extensions Enclaves and Protect your Application at Runtime</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org66b80bb">A quick Overview of the Service</a></li>
<li><a href="#org65a02d7">Deploy the Data Shield Service on your Kubernetes Cluster</a>
<ul>
<li><a href="#orgd807425">Prerequisites</a></li>
<li><a href="#org63f4a65">Set up your Kubernetes Cluster</a></li>
<li><a href="#orge03529b">Cluster Configuration</a></li>
<li><a href="#org5eeee98">Adding the necessary helm-charts to your Cluster</a></li>
<li><a href="#orga48086e">Creating your image registry on IBM cloud</a></li>
<li><a href="#orgf248ac6">Create a Kubectl Secret to interact with your Cluster at a later stage.</a></li>
<li><a href="#orgdb62f0c">Install the IBM Kubernetes Data Shield Chart</a></li>
</ul>
</li>
<li><a href="#orgcc3fec8">Convert an image into a SGX-complaint image and deploy it on your cluster</a>
<ul>
<li><a href="#orgaf37430">Via UI</a></li>
<li><a href="#orge49d27c">Via CLI</a></li>
</ul>
</li>
</ul>
</div>
</div>
<style>
.container {
  position: relative;
  left: 15%;
  width: 70%;
  margin-top: 60px;
  margin-bottom: 60px;
  overflow: hidden;
  padding-top: 56.25%; /* 16:9 Aspect Ratio */
  display:block;
  overflow-y: hidden;
}

.responsive-iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: none;
  display:block;
  overflow-y: hidden;
}
</style>

<br>
<br>

<p>
<i>Disclaimer: This is not an official documentation and is not maintained. It is rather ment to be a support to the <a href="https://cloud.ibm.com/docs/data-shield?topic=data-shield-getting-started">existing official
documentation</a> to the present state - October 2020.</i> 
</p>

<br>
<br>

<div id="outline-container-org66b80bb" class="outline-2">
<h2 id="org66b80bb">A quick Overview of the Service</h2>
<div class="outline-text-2" id="text-org66b80bb">
<p>
The essential idea of IBM Data Shield is the one of partnering with
Fortanix to offer an easy to use service in order to protect your
applications via Software Guard Extensions enabled Intel processors. 
</p>

<p>
The idea is that through the extension/remodularization of the
processor architecture it is possible to deploy an application in a so
called <i>enclave</i>, i.e. a hardware defined protected environment. In
such a way your OS or VMM will be just able to page in and out the
application enclaves, however they will not be allowed to access the
data of the runtime or to tamper them.
</p>

<p>
The result is a highly reduced attack surface for a malicious
entity. Even if your infrastructure level security fails and you loose
control over the OS/BIOS/Drivers your data will be protected as it
won't be possible to read out data running on enclaves. <sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>
</p>

<p>
IBM partnered with Fortanix to offer the solution above in order to
increase the achievable security level of cloud applications and make
new cloud business models possible. 
</p>

<p>
Through the mentioned partnership, the IBM Data Shield solution will
make it possible for you to convert any docker image into
SGX-compliant images in minutes without changing a single line of
code. It will then be possible for you as an operator to leverage the
full fledge power of SGX architectures and to deploy runtime encrypted
applications on your kubernetes or <a href="https://www.openshift.com/">openshift</a> cluster in minutes.
</p>

<div class="container"> 
  <iframe class="responsive-iframe" src="https://player.vimeo.com/video/203331381" frameborder="0" allowfullscreen;> </iframe>
</div>
</div>
</div>

<div id="outline-container-org65a02d7" class="outline-2">
<h2 id="org65a02d7">Deploy the Data Shield Service on your Kubernetes Cluster</h2>
<div class="outline-text-2" id="text-org65a02d7">
</div>
<div id="outline-container-orgd807425" class="outline-3">
<h3 id="orgd807425">Prerequisites</h3>
<div class="outline-text-3" id="text-orgd807425">
<p>
Install the <i><a href="https://cloud.ibm.com/docs/cli?topic=cloud-cli-getting-started">IBM CLI</a></i>
</p>

<div class="org-src-container">
<pre class="src src-sh">  curl -sL https://ibm.biz/idt-installer | bash
</pre>
</div>

<p>
The above will install IBMCloud together with a couple of CLI useful for every developer. 
In particular it will install:
</p>

<pre class="example">
  - Homebrew (Mac only)
  - Git
  - Docker
  - Helm
  - kubectl
  - curl (Linux™ only)
  - IBM Cloud Developer Tools plug-in
  - IBM Cloud Functions plug-in
  - IBM Cloud Object Storage plug-in
  - IBM Cloud Container Registry plug-in
  - IBM Cloud Kubernetes Service plug-in
</pre>

<p>
Another option will be the one of installing the necessary tools:
</p>

<ul class="org-ul">
<li>IBM Cloud</li>
<li>Kubernetes</li>
<li>Docker</li>
<li>Helm</li>
<li>Kubernetes Service (ibmcloud plugin)</li>
<li>Container Registry (ibmcloud plugin)</li>
</ul>

<p>
individually.
</p>

<p>
A good place to get started in this sense is to login in the IBM cloud via CLI through 
</p>

<div class="org-src-container">
<pre class="src src-sh">  ibmcloud login <span style="color: #51afef;">[</span>-a API_ENDPOINT<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>--sso<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>-u USERNAME<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>-p PASSWORD<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>--apikey KEY | @KEY_FILE<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>--no-iam<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>-c <span style="color: #c678dd;">(</span>ACCOUNT_ID | ACCOUNT_OWNER_USER_ID<span style="color: #c678dd;">)</span> | --no-account<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>-g <span style="color: #c678dd;">(</span>RESOURCE_GROUP_NAME | RESOURCE_GROUP_ID<span style="color: #c678dd;">)</span><span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>-r REGION | --no-region<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>-o ORG<span style="color: #51afef;">]</span> <span style="color: #51afef;">[</span>-s SPACE<span style="color: #51afef;">]</span>
</pre>
</div>

<p>
and look at the available <i>plug-ins</i>, the installed ones and the <i>available updates</i>:
</p>

<div class="org-src-container">
<pre class="src src-sh">  ibmcloud plugin repo-plugins -r <span style="color: #bcd42a;">"IBM Cloud"</span>
</pre>
</div>

<p>
You can then install ibmcloud plugins through 
</p>

<div class="org-src-container">
<pre class="src src-sh">  ibmcloud plugin install container-registry

  ibmcloud plugin install kubernetes-service
</pre>
</div>

<p>
Moreover, you can install the necessary Kubernetes, Docker and Helm
CLI from the internet should you not be willing of running the bash
script above.
</p>
</div>
</div>


<div id="outline-container-org63f4a65" class="outline-3">
<h3 id="org63f4a65">Set up your Kubernetes Cluster</h3>
<div class="outline-text-3" id="text-org63f4a65">
<p>
Notice: In order to leverage the IBM Data Shield service, it will
be necessary for you to deploy a bare metal Kubernetes cluster
running on SGX enabled processors. Moreover, to the present stage you
will have to select a cluster running on the Ubuntu 16 OS,
i.e. either the <code>mb2c.4x32</code> cluster as done in this demo, or the
<code>mb2c.4x32.1.9tb.ssd</code> model.
</p>

<div class="container"> 
  <iframe class="responsive-iframe" src="https://www.youtube.com/embed/pEA1y9c_xqs" frameborder="0" allowfullscreen;> </iframe>
</div>
</div>
</div>


<div id="outline-container-orge03529b" class="outline-3">
<h3 id="orge03529b">Cluster Configuration</h3>
<div class="outline-text-3" id="text-orge03529b">
<p>
After provisioning the above cluster you should receive an E-mail a
couple of hours later, when your cluster is up and running.
</p>

<p>
You should be then be able to find your cluster via the IBM
kubernetes CLI plug-in.
</p>

<div class="org-src-container">
<pre class="src src-sh"> ibmcloud ks cluster ls
</pre>
</div>

<pre class="example">
 OK
 Name                              ID                     State    Created       Workers   Location    Version        Resource Group Name   Provider   
 mycluster-fra02-mb2c.Datashield   bti5pcef0j3046qt1ks0   normal   2 weeks ago   1         Frankfurt   1.17.12_1540   Default               classic   
</pre>

<p>
You can read from the above the ID of your cluster as well as it's
<i>state</i>. This should be in the normal state as in the above case.
</p>

<p>
Through the above cluster-ID it is then possible to connect your
local kubernetes CLI with the created cluster. In such a way you will
be able to operate on your cluster via the kubernetes CLI locally. 
</p>

<p>
In order to do that, you can run the following command:
</p>

<div class="org-src-container">
<pre class="src src-sh"> ibmcloud ks cluster config --cluster bti5pcef0j3046qt1ks0                                                                                        &lt;
</pre>
</div>

<pre class="example">
 OK
 The configuration for bti5pcef0j3046qt1ks0 was downloaded successfully.

 Added context for bti5pcef0j3046qt1ks0 to the current kubeconfig file.
 You can now execute 'kubectl' commands against your cluster. For example, run 'kubectl get nodes'.
</pre>

<p>
You can then verify that your CLI is correctly configured with your
cluster by running
</p>

<div class="org-src-container">
<pre class="src src-sh"> kubectl cluster-info
</pre>
</div>

<pre class="example">
 Kubernetes master is running at https://c106.eu-de.containers.cloud.ibm.com:31398
 CoreDNS is running at https://c106.eu-de.containers.cloud.ibm.com:31398/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
 kubernetes-dashboard is running at https://c106.eu-de.containers.cloud.ibm.com:31398/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy                          
 Metrics-server is running at https://c106.eu-de.containers.cloud.ibm.com:31398/api/v1/namespaces/kube-system/services/https:metrics-server:/proxy
 NodeLocalDNS is running at https://c106.eu-de.containers.cloud.ibm.com:31398/api/v1/namespaces/kube-system/services/node-local-dns:dns/proxy

 To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.
</pre>

<p>
You can then compare this information with the one obtained through
the ibmcloud kubernetes CLI plug-in
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud ks cluster get --cluster bti5pcef0j3046qt1ks0                                                                                          
</pre>
</div>

<pre class="example">
Retrieving cluster bti5pcef0j3046qt1ks0...
OK
                                   
Name:                           mycluster-fra02-mb2c.Datashield   
ID:                             bti5pcef0j3046qt1ks0   
State:                          normal   
Created:                        2020-09-18T07:07:29+0000   
Location:                       fra02   
Master URL:                     https://c106.eu-de.containers.cloud.ibm.com:31398   
Public Service Endpoint URL:    https://c106.eu-de.containers.cloud.ibm.com:31398   
Private Service Endpoint URL:   -   
Master Location:                Frankfurt   
Master Status:                  Ready (1 week ago)   
Master State:                   deployed   
Master Health:                  normal   
Ingress Subdomain:              mycluster-fra02-mb2c-da-f9bf7c7800de9856ddeffe14aad922a5-0000.eu-de.containers.appdomain.cloud   
Ingress Secret:                 mycluster-fra02-mb2c-da-f9bf7c7800de9856ddeffe14aad922a5-0000   
Workers:                        1   
Worker Zones:                   fra02   
Version:                        1.17.12_1540   
Creator:                        -   
Monitoring Dashboard:           -   
Resource Group ID:              f274228d8aa542fb8d3d120e7215071d   
Resource Group Name:            Default   
</pre>
</div>
</div>


<div id="outline-container-org5eeee98" class="outline-3">
<h3 id="org5eeee98">Adding the necessary helm-charts to your Cluster</h3>
<div class="outline-text-3" id="text-org5eeee98">
<p>
For running datashield, you will then be asked to install a couple of
helm charts on your cluster. These will be necessary for the proper
configuration of your service.
</p>

<p>
Helm charts, are kubernetes resources which are packaged together in
an easy to deploy way for developers. You can think them in terms of
libraries that trigger kubernetes configuration files.
</p>

<p>
In order to do that by following this documentation make sure that you
are using the helm client in it's third version
</p>

<div class="org-src-container">
<pre class="src src-sh">helm version
</pre>
</div>

<pre class="example">
version.BuildInfo{Version:"v3.2.3", GitCommit:"8f832046e258e2cb800894579b1b3b50c2d83492", GitTreeState:"clean", GoVersion:"go1.13.12"}
</pre>

<p>
You will then be able to add to the helm client the IBM kubernetes helm
charts.
</p>

<div class="org-src-container">
<pre class="src src-sh">helm repo add iks-charts https://icr.io/helm/iks-charts
</pre>
</div>

<p>
You can finally add the IBM kubernetes helm charts to your repository
</p>

<div class="org-src-container">
<pre class="src src-sh">helm repo add iks-charts https://icr.io/helm/iks-charts
</pre>
</div>

<p>
And finally install the cert-manager chart to issue certificates in
your cluster. 
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl apply --validate=false -f https://raw.githubusercontent.com/jetstack/cert-manager/v0.10.1/deploy/manifests/00-crds.yaml
</pre>
</div>

<p>
Create a namespace on your cluster where to deploy your cert-manager
chart issuing the necessary certificates. Finally give it a label to
reference it at later points.
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl create namespace cert-manager
kubectl label namespace cert-manager certmanager.k8s.io/disable-validation=true
</pre>
</div>

<p>
Add the jetstack charts to your repository
</p>

<p>
Install the cert-manager chart in the cert-manager namespace
</p>

<div class="org-src-container">
<pre class="src src-sh">helm repo update &amp;&amp; helm install cert-manager jetstack/cert-manager --namespace cert-manager --version v0.10.1 --set <span style="color: #f8f8f0;">extraArgs</span><span style="color: #51afef;">[</span>0<span style="color: #51afef;">]</span>=<span style="color: #bcd42a;">"--enable-certificate-owner-ref=true"</span> --set webhook.enabled=false
</pre>
</div>

<p>
You should then be able to observe the deployed pods from the helm
chart in the cert-manager namespace
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get pods --namespace=cert-manager
</pre>
</div>

<pre class="example">
| NAME                                    | READY | STATUS  | RESTARTS | AGE |
| cert-manager-87f84bbbb-m2ghd            | 1/1   | Running |        0 | 19d |
| cert-manager-cainjector-98fb4f86c-brdd5 | 1/1   | Running |        1 | 19d |
</pre>
</div>
</div>


<div id="outline-container-orga48086e" class="outline-3">
<h3 id="orga48086e">Creating your image registry on IBM cloud</h3>
<div class="outline-text-3" id="text-orga48086e">
<p>
So far so good.
</p>

<p>
In this section we will create an IBM container registry where you can
upload your docker images. 
</p>

<p>
This will be a private registry so that you can keep your code
proprietary.
</p>

<p>
Again you will need the container-registry ibmcloud CLI plug-in.
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud cr login
</pre>
</div>

<p>
You can then select a region where to host your registry. This you
will need to pass at a later stage when creating a kubernetes secret
in order to interact with the registry.
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud cr region-set
</pre>
</div>

<pre class="example">
1. ap-north ('jp.icr.io')
2. ap-south ('au.icr.io')
3. eu-central ('de.icr.io')
4. global ('icr.io')
5. uk-south ('uk.icr.io')
6. us-south ('us.icr.io')
Enter a number ()&gt; 3
The region is set to 'eu-central', the registry is 'de.icr.io'.

OK
</pre>

<p>
You will then add a namespace to the registry endpoint. You will have
access to such namespace and manage your docker images from there.
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud cr namespace-add datashield_mahass
</pre>
</div>

<p>
Check the successful creation of the namespace
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud cr namespace-list
</pre>
</div>

<pre class="example">
Listing namespaces for account 'IBM' in registry 'de.icr.io'...

Namespace   
datashield_mahass   

OK
</pre>

<p>
You can now add images to your namespace and check what is available
on your registry
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud cr image-list
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf248ac6" class="outline-3">
<h3 id="orgf248ac6">Create a Kubectl Secret to interact with your Cluster at a later stage.</h3>
<div class="outline-text-3" id="text-orgf248ac6">
<p>
In this section you will create a IAM service-id and give it a
reader and writer permission to operate on your cluster. You will
then use the created API key when issuing the commands to convert
existing docker images into SGX-compliant images. In fact, you will
pass the API key to a kubernetes secret that you will use when
converting images.
</p>

<p>
<b>Important!</b> It is essential to notice that you should create such
kubernetes secret before installing the IBM data shield helm
chart. This will refer in fact to the created kubernetes service.<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>
</p>

<p>
Create a IAM service to interact with your cluster
</p>

<div class="org-src-container">
<pre class="src src-sh">  ibmcloud iam service-id-create data-shield-container-converter -d <span style="color: #bcd42a;">'IBM Cloud Data Shield Container Converter'</span>
</pre>
</div>

<p>
Create an Api-key for that service 
</p>

<div class="org-src-container">
<pre class="src src-sh">  ibmcloud iam service-api-key-create <span style="color: #bcd42a;">'IBM Cloud Data Shield Container Converter'</span> data-shield-container-converter
</pre>
</div>

<pre class="example">
Creating API key Data Shield Container Converter of service ID data-shield-container-converter under account &lt;XXX&gt; as Marco.Hassan@ibm.com...                                                                                                                             
OK
Service ID API key Data Shield Container Converter is created

Please preserve the API key! It cannot be retrieved after it's created.
                 
ID            ApiKey-1eaab4fb-3d2e-4937-b4e4-0684f1d4a91c   
Name          Data Shield Container Converter   
Description      
Created At    2020-09-24T12:46+0000   
API Key       &lt;READ YOUR API KEY FROM HERE&gt;   
Locked        false   
</pre>


<p>
Notice that the Api key was removed from the above for security
reasons. You will find it at the <code>&lt;READ YOUR API KEY FROM HERE&gt;</code>
above. Make a note of it as you will need it shortly when creating
the kubernetes secret.
</p>

<p>
Create a IAM policy specifying the policy for which you can interact
to your cluster with the IAM service
</p>

<div class="org-src-container">
<pre class="src src-sh">  ibmcloud iam service-policy-create data-shield-container-converter --roles Reader,Writer --service-name container-registry
</pre>
</div>

<p>
Create a Kubernetes secret to be used for future
conversions. Notice that you will have to replace the <code>&lt;ENTER YOUR
   CONTAINER REGISTRY REGION HERE&gt;</code> and the <code>&lt;ENTER HERE YOUR API KEY
   FOR THE IAM SERVICE ABOVE&gt;</code> strings from the snippet below.
</p>

<div class="org-src-container">
<pre class="src src-sh">  <span style="color: #51afef;">(</span><span style="color: #ff5d38;">echo</span> -n <span style="color: #bcd42a;">'{"auths":{"&lt;ENTER YOUR CONTAINER REGISTRY REGION HERE&gt;.icr.io":{"auth":"'</span>; <span style="color: #ff5d38;">echo</span> -n <span style="color: #bcd42a;">'iamapikey:&lt;ENTER HERE YOUR API KEY FOR THE IAM SERVICE ABOVE&gt;'</span> | openssl base64 -A;  <span style="color: #ff5d38;">echo</span> <span style="color: #bcd42a;">'"}}}'</span><span style="color: #51afef;">)</span> | kubectl create secret generic converter-docker-config --from-file=.dockerconfigjson=/dev/stdin
</pre>
</div>

<p>
Where the container registry endpoint is the region you selected for
your image repository in the previous section. In my case hence
<code>de</code>, such that the above becomes <code>de.icr.io</code> and the API key is the
one you generated right above.
</p>

<p>
You can then verify the existence of your kubernetes secret by 
running
</p>

<div class="org-src-container">
<pre class="src src-sh">  kubectl create secret generic converter-docker-config
</pre>
</div>

<pre class="example">
{                                                                                                                                               
    "apiVersion": "v1",                                                                                                                         
    "data": {
        ".dockerconfigjson": &lt;base-64 authorization string passed above&gt;
    },
    "kind": "Secret",
    "metadata": {
        "creationTimestamp": "2020-10-01T14:13:50Z",
        "name": "converter-docker-config",
        "namespace": "default",
        "resourceVersion": "3918214",
        "selfLink": "/api/v1/namespaces/default/secrets/converter-docker-config",
        "uid": "661fd885-e0c9-4212-93a7-849681cd504b"
    },
    "type": "Opaque"
}
</pre>
</div>
</div>


<div id="outline-container-orgdb62f0c" class="outline-3">
<h3 id="orgdb62f0c">Install the IBM Kubernetes Data Shield Chart</h3>
<div class="outline-text-3" id="text-orgdb62f0c">
<p>
Good, you are all set. You can now get the necessary information
about your cluster and install the Data Shield Chart on your
Cluster.
</p>

<p>
First of all get your IBM account HEX number
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud account show
</pre>
</div>

<pre class="example">
Retrieving account IBM of Marco.Hassan@ibm.com...
OK
                                       
Account Name:                       IBM   
Account ID:                         &lt;HERE YOU FIND THE HEX ACCOUNT NUMBER&gt;
Account Owner:                      marco.hassan@ibm.com   
Account Type:                       PAYG   
Account Status:                     ACTIVE   
Linked Softlayer Account:           xxx   
VRF Enabled:                        false   
Service Endpoint Enabled:           false   
EU Supported                        false   
PoC (Commercial Proof of Concept)   false   
HIPAA Supported                     false   
</pre>

<p>
Secondly get the Ingress Subdomain of your cluster, by running again
the command
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud ks cluster get --cluster bti5pcef0j3046qt1ks0
</pre>
</div>

<pre class="example">

......

Ingress Subdomain:              mycluster-fra02-mb2c-da-f9bf7c7800de9856ddeffe14aad922a5-0000.eu-de.containers.appdomain.cloud   

......

</pre>

<p>
Make not of the ingress subdomain or enter it into a variable as you
will use it extensively throughout the next sections.
</p>

<div class="org-src-container">
<pre class="src src-sh">  <span style="color: #f8f8f0;">subdomain_ingress</span>=<span style="color: #bcd42a;">"mycluster-fra02-mb2c-da-f9bf7c7800de9856ddeffe14aad922a5-0000.eu-de.containers.appdomain.cloud"</span>

  <span style="color: #ff5d38;">echo</span> $<span style="color: #f8f8f0;">subdomain_ingress</span>
</pre>
</div>

<pre class="example">
mycluster-fra02-mb2c-da-f9bf7c7800de9856ddeffe14aad922a5-0000.eu-de.containers.appdomain.cloud
</pre>

<p>
Finally install the datashield chart in the default namespace of your
cluster (recall to insert the <code>HEX number</code> of the account in the below snippet)
</p>

<div class="org-src-container">
<pre class="src src-sh">helm install myshield iks-charts/ibmcloud-data-shield --set enclaveos-chart.Manager.AdminEmail=Marco.Hassan@ibm.com --set enclaveos-chart.Manager.AdminName=Marco.Hassan@ibm.com --set enclaveos-chart.Manager.AdminIBMAccountId=&lt;ENTER PREVIOUSLY OBTAINED HEX&gt; --set global.IngressDomain=$<span style="color: #f8f8f0;">subdomain_ingress</span> --set converter-chart.Converter.DockerConfigSecret=converter-docker-config
</pre>
</div>

<p>
Fantastic, if that worked you are good to go.
</p>

<p>
Check that all of the pods are running correctly
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get pods
</pre>
</div>

<pre class="example">
NAME                                                            READY   STATUS      RESTARTS   AGE
data-shield-setup-q4rng                                         0/1     Completed   0          26m
pmyshield-enclaveos-agent-mhn55                                  2/2     Running     2          26m
myshield-enclaveos-cockroachdb-0                                1/1     Running     0          26m
myshield-enclaveos-cockroachdb-init-wb8cm                       0/1     Completed   0          26m
myshield-enclaveos-cockroachdb-status-checker-86bdff5ff-7rz29   1/1     Running     0          26m
myshield-enclaveos-converter-76947448b7-cmvrn                   2/2     Running     0          26m
myshield-enclaveos-dkms-z4xll                                   1/1     Running     2          26m
myshield-enclaveos-frontend-868b5dbc5c-68ww6                    1/1     Running     0          26m
myshield-enclaveos-manager-0                                    2/2     Running     1          26m
myshield-sgx-6j87h                                              1/1     Running     1          26m
myshield-sgx-device-plugin-hp2rf                                1/1     Running     0          26m
</pre>

<p>
Moreover you can get the link to your datashield UI by:
</p>

<div class="org-src-container">
<pre class="src src-sh">helm status myshield                                                                                                                            
</pre>
</div>

<pre class="example">
NAME: myshield
LAST DEPLOYED: Fri Sep 18 14:42:52 2020
NAMESPACE: default
STATUS: deployed
REVISION: 1
TEST SUITE: None
NOTES:
Thank you for installing ibmcloud-data-shield.

Your release is named myshield.

To learn more about the release, try:

  $ helm status myshield
  $ helm get myshield

You can access the Enclave Manager web console at https://enclave-manager.mycluster-fra02-mb2c-da-f9bf7c7800de9856ddeffe14aad922a5-0000.eu-de.containers.appdomain.cloud

Documentation may be found at https://console.bluemix.net/docs/services/data-shield/index.html
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcc3fec8" class="outline-2">
<h2 id="orgcc3fec8">Convert an image into a SGX-complaint image and deploy it on your cluster</h2>
<div class="outline-text-2" id="text-orgcc3fec8">
<p>
Good now that your cluster is up an running with the data shield
service you can convert a docker image of your choice.
</p>

<p>
For this tutorial I used the image build through <a href="https://github.com/MarcoHassan/Datashield/tree/main/my_datashield_image">this
repository</a>. Notice that in the image you are not really leveraging
any data or doing any kind of computation so using Data Shield for
deployment is a bit of a moot point. However, you can think yourself
how that would look if you would use such a python runtime to perform
some ML job on sensitive data or when deploying a database image.
</p>

<p>
In order to demonstrate the point of the simplicity of converting
and running images on your cluster in protected enclaves we will
show how to convert the image above without loss of generality.
</p>

<p>
First of all download the repository, then within it you can run
</p>

<div class="org-src-container">
<pre class="src src-sh">  <span style="color: #5B6268;">## </span><span style="color: #5B6268;">in the my_datashield_image repository with the Dockerfile</span>
  docker build -t de.icr.io/datashield_mahass/falsk_dashboard:v1 .
</pre>
</div>

<pre class="example">
Sending build context to Docker daemon  3.993MB
Step 1/9 : FROM python:3.7.5-stretch
 ---&gt; 79d26a5ecb0f
Step 2/9 : RUN apt-get update &amp;&amp; apt-get install -y python3-dev build-essential
 ---&gt; Using cache
 ---&gt; b4dd3a7b5ba8
Step 3/9 : WORKDIR /app
 ---&gt; Using cache
 ---&gt; b29fa1a3d351
Step 4/9 : ADD . /app
 ---&gt; cccd75c67ef1
Step 5/9 : RUN pip install --upgrade pip
 ---&gt; Running in 63f9ceba9273
Collecting pip
  Downloading https://files.pythonhosted.org/packages/4e/5f/528232275f6509b1fff703c9280e58951a81abe24640905de621c9f81839/pip-20.2.3-py2.py3-none-any.whl (1.5MB)
Installing collected packages: pip
  Found existing installation: pip 19.3.1
    Uninstalling pip-19.3.1:
      Successfully uninstalled pip-19.3.1
Successfully installed pip-20.2.3
Removing intermediate container 63f9ceba9273
 ---&gt; 2574453abbe2
Step 6/9 : RUN pip install --no-cache-dir -r requirements.txt
 ---&gt; Running in 780119f2e3fd
Collecting Flask==1.1.2
  Downloading Flask-1.1.2-py2.py3-none-any.whl (94 kB)
Collecting itsdangerous&gt;=0.24
  Downloading itsdangerous-1.1.0-py2.py3-none-any.whl (16 kB)
Collecting Werkzeug&gt;=0.15
  Downloading Werkzeug-1.0.1-py2.py3-none-any.whl (298 kB)
Collecting click&gt;=5.1
  Downloading click-7.1.2-py2.py3-none-any.whl (82 kB)
Collecting Jinja2&gt;=2.10.1
  Downloading Jinja2-2.11.2-py2.py3-none-any.whl (125 kB)
Collecting MarkupSafe&gt;=0.23
  Downloading MarkupSafe-1.1.1-cp37-cp37m-manylinux1_x86_64.whl (27 kB)
Installing collected packages: itsdangerous, Werkzeug, click, MarkupSafe, Jinja2, Flask
Successfully installed Flask-1.1.2 Jinja2-2.11.2 MarkupSafe-1.1.1 Werkzeug-1.0.1 click-7.1.2 itsdangerous-1.1.0
Removing intermediate container 780119f2e3fd
 ---&gt; dc85014ded2f
Step 7/9 : EXPOSE 80
 ---&gt; Running in c4007edd8de9
Removing intermediate container c4007edd8de9
 ---&gt; 004cedcebb18
Step 8/9 : ENV NAME World
 ---&gt; Running in 5921e7006115
Removing intermediate container 5921e7006115
 ---&gt; 1ecdf60bdfa2
Step 9/9 : CMD ["python", "app.py"]
 ---&gt; Running in c9780ef6591f
Removing intermediate container c9780ef6591f
 ---&gt; dbab8de5e45d
Successfully built dbab8de5e45d
Successfully tagged flask_dashboard:v1
</pre>

<div class="org-src-container">
<pre class="src src-sh">  docker push de.icr.io/datashield_mahass/flask_dashboard:v1
</pre>
</div>

<pre class="example">
The push refers to repository [de.icr.io/datashield_mahass/flask_dashboard]
cc6d8796e68b: Pushed 
f8715e0bcea3: Pushed 
ee7190eed877: Pushed 
dac60d802f72: Mounted from datashield_mahass/coursera_workflow 
5c478a56abb2: Mounted from datashield_mahass/coursera_workflow 
5ac01c082b52: Mounted from datashield_mahass/coursera_workflow 
52e609561bfc: Mounted from datashield_mahass/coursera_workflow 
d7366bbef1d9: Mounted from datashield_mahass/coursera_workflow 
d7aa66fec7c0: Mounted from datashield_mahass/coursera_workflow 
2e517d68c391: Mounted from datashield_mahass/coursera_workflow 
5f3a5adb8e97: Mounted from datashield_mahass/coursera_workflow 
73bfa217d66f: Mounted from datashield_mahass/coursera_workflow 
91ecdd7165d3: Mounted from datashield_mahass/coursera_workflow 
e4b20fcc48f4: Mounted from datashield_mahass/coursera_workflow 
v1: digest: sha256:d9338d9c2d5231a19742674998a74e604fbe5f89dd80fae008c91be079913531 size: 3270
</pre>


<p>
You can then verify that your image was uploaded to your IBM cloud
registry by running
</p>

<div class="org-src-container">
<pre class="src src-sh">ibmcloud cr image-list
</pre>
</div>

<p>
Great, you can now convert the image.
</p>

<p>
For doing that you can either use the Enclave Manager UI, or
alternatively use the CLI and send the correct information to the
Data Shield API.
</p>
</div>

<div id="outline-container-orgaf37430" class="outline-3">
<h3 id="orgaf37430">Via UI</h3>
<div class="outline-text-3" id="text-orgaf37430">
<div class="container"> 
  <iframe class="responsive-iframe" src="https://www.youtube.com/embed/Oixdcha11h4" frameborder="0" allowfullscreen;> </iframe>
</div>
</div>
</div>

<div id="outline-container-orge49d27c" class="outline-3">
<h3 id="orge49d27c">Via CLI</h3>
<div class="outline-text-3" id="text-orge49d27c">
<p>
In order to convert the images via CLI you can pass the necessary
parameters together with an authentication token to the converter API
endpoint.
</p>

<p>
In order to do that you first generate the access token via:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #ff5d38;">export</span> <span style="color: #f8f8f0;">token</span>=<span style="color: #ff5d38; font-weight: bold;">`ibmcloud iam oauth-tokens | awk -F"Bearer " '{print $NF}'`</span>
<span style="color: #ff5d38;">echo</span> $<span style="color: #f8f8f0;">token</span>
</pre>
</div>

<pre class="example">
eyJraWQiOiIyMDIwMDkyMjE4MzMiLCJhbGciOiJSUzI1NiJ9.eyJpYW1faWQiOiJJQk1pZC01NTAwMDQ0SzdBIiwiaWQiOiJJQk1pZC01NTAwMDQ0SzdBIiwicmVhbG1pZCI6IklCTWlkIiwianRpIjoiOTgxZGViYmQtOGY1My00ZmUzLWJlYTMtMzA3ZmI5YTlhYTk3IiwiaWRlbnRpZmllciI6IjU1MDAwNDRLN0EiLCJnaXZlbl9uYW1lIjoiTWFyY28iLCJmYW1pbHlfbmFtZSI6Ikhhc3NhbiIsIm5hbWUiOiJNYXJjbyBIYXNzYW4iLCJlbWFpbCI6Ik1hcmNvLkhhc3NhbkBpYm0uY29tIiwic3ViIjoiTWFyY28uSGFzc2FuQGlibS5jb20iLCJhY2NvdW50Ijp7InZhbGlkIjp0cnVlLCJic3MiOiI3NWM0YzRlYmJhZmY0MGEzOTM1ZjA2OWJmY2VjNjVhOSIsImltc191c2VyX2lkIjoiNzg2ODk5NCIsImltcyI6IjE5OTU0MjIifSwiaWF0IjoxNjAyMTU2MTM4LCJleHAiOjE2MDIxNTk3MzgsImlzcyI6Imh0dHBzOi8vaWFtLmNsb3VkLmlibS5jb20vaWRlbnRpdHkiLCJncmFudF90eXBlIjoidXJuOmlibTpwYXJhbXM6b2F1dGg6Z3JhbnQtdHlwZTpwYXNzY29kZSIsInNjb3BlIjoiaWJtIG9wZW5pZCIsImNsaWVudF9pZCI6ImJ4IiwiYWNyIjoxLCJhbXIiOlsicHdkIl19.dpy_LEsdh7UnFPsyPdi_m0rNYrvj2p10w9xZdWHfZOIR_GaqQqN3O_s4TjqTXgxyTowPOjAZZZ_wLp-bsgUgT32MfFyva9PK3yH1mwmdvyCh_3eKqHqmZSWsMFMJC5s7wQpu2PLWXB6S9hTgoka-t0Cvk-eM2V-txcpsTxDiThWFtNSId0RpOsrrfeIdS3Wi9GYRzbNl9O9Wyt-gtE_HK4nkrgQzRk0nHTERE7B1SnILFGF1iWZyvZeDs_cj04e9wsPkSWgcEvII-vDvlqMeduVZGQsQDwKVcBT2It_XHmisag_G8-ddmFzxVPaPc8to3ErPpBT1QyZhAGOSfTO6yg
</pre>

<p>
Then you pass it together with the image name to be converted, the
image output name as well as the cluster ingress point + api route
(notice that the snippet below uses the $subdomain<sub>ingress</sub> variable
previously defined):
</p>

<div class="org-src-container">
<pre class="src src-sh">curl -H <span style="color: #bcd42a;">'Content-Type: application/json'</span> -d <span style="color: #bcd42a;">'{"inputImageName": "de.icr.io/datashield_mahass/flask_dashboard:v1", "outputImageName": "de.icr.io/datashield_mahass/sgx_flask_dashboard:latest"}'</span>  -H <span style="color: #bcd42a;">"Authorization: Basic $token"</span>  https://enclave-manager.$<span style="color: #f8f8f0;">subdomain_ingress</span>/api/v1/tools/converter/convert-app
</pre>
</div>

<pre class="example">
{"isvsvn": 0, "newImage": "de.icr.io/datashield_mahass/sgx_flask_dashboard:latest", "mrenclave": "5a4db6b8730cc48172edbf230ef9e30d49f2021c82cf94bd22824b792d56d850", "imageSize": 1144509494, "imageSHA": "6ba65e6d89fb", "isvprodid": 0, "mrsigner": "83a625398a0ff03a60c31635d3116021de498fe77ef25cb29cb0f0afc98dbd52"}
</pre>

<p>
You can finally run the image on your cluster by running the
deployment and services <code>yaml</code> files in the repository. Notice,
though, that you will have to change the url of the image referenced
in such files.
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get pods -o wide                                                                                                                                             
</pre>
</div>

<pre class="example">
NAME                                                            READY   STATUS      RESTARTS   AGE     IP              NODE            NOMINATED NODE   READINESS GATES
data-shield-setup-q4rng                                         0/1     Completed   0          20d     172.30.128.18   10.215.171.81   &lt;none&gt;           &lt;none&gt;
java-hello-world                                                0/1     Completed   0          14d     172.30.128.34   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myflaskapp-deploy-84dffc55df-jdrbc                              1/1     Running     0          167m    172.30.128.49   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-agent-mhn55                                  2/2     Running     2          20d     10.215.171.81   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-cockroachdb-0                                1/1     Running     0          20d     172.30.128.24   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-cockroachdb-init-wb8cm                       0/1     Completed   0          20d     172.30.128.22   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-cockroachdb-status-checker-86bdff5ff-7rz29   1/1     Running     0          20d     172.30.128.21   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-converter-76947448b7-7b2vf                   2/2     Running     0          6d22h   172.30.128.41   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-dkms-z4xll                                   1/1     Running     2          20d     10.215.171.81   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-frontend-868b5dbc5c-68ww6                    1/1     Running     0          20d     172.30.128.19   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-enclaveos-manager-0                                    2/2     Running     1          20d     172.30.128.25   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-sgx-6j87h                                              1/1     Running     1          20d     10.215.171.81   10.215.171.81   &lt;none&gt;           &lt;none&gt;
myshield-sgx-device-plugin-hp2rf                                1/1     Running     0          20d     172.30.128.20   10.215.171.81   &lt;none&gt;           &lt;none&gt;
sgx-flask-dashboard-5c968f5c5b-krvbd                            1/1     Running     0          7s      172.30.128.55   10.215.171.81   &lt;none&gt;           &lt;none&gt;
</pre>

<div class="org-src-container">
<pre class="src src-sh">kubectl get deployments                                                                                                                                              
</pre>
</div>

<pre class="example">
NAME                                            READY   UP-TO-DATE   AVAILABLE   AGE
myflaskapp-deploy                               1/1     1            1           167m
myshield-enclaveos-cockroachdb-status-checker   1/1     1            1           20d
myshield-enclaveos-converter                    1/1     1            1           20d
myshield-enclaveos-frontend                     1/1     1            1           20d
sgx-flask-dashboard                             1/1     1            1           12s
</pre>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
The interested reader that wants to go deeper in the
technicalities of SGX might refer to <a href="https://www.youtube.com/watch?v=mPT_vJrlHlg&amp;t=2502s">this video</a>.
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
Should you be creating the kubernetes secret after having
installed your datashield IBM helm chart, you will need to remove
the <code>myshield-enclaveos-converter-xxx</code> pod from your cluster and
wait until the deployment file creates a new pod that refers to the
newly created secret.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="date">Date: 2020-10-07</p>
<p class="author">Author: Marco Hassan</p>
<p class="date">Created: 2020-10-09 Fri 14:30</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
